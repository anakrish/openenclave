// Copyright (c) Open Enclave SDK contributors.
// Licensed under the MIT License.

enclave {

   struct SecurityS {
       [size=4] int* ptr;
   };

   trusted {
      // Get address of trusted location.
      public int* security_get_secret_ptr();

      // trusted memory address as ECALL parameter, will not leak secrets.
      public void security_ecall_test1([size = 4,in] int* ptr);

      // trusted memory address as ECALL parameter via deepcopy, will not leak secrets.
      public void security_ecall_test2([in] SecurityS* s);

      // trusted memory address as ECALL in/out parameter, will not leak secrets.
      public void security_ecall_test3([size = 4, in, out] int* ptr);

      // trusted memory address as ECALL in/out parameter via deepcopy, will not leak secrets.
      public void security_ecall_test4([count=1, in, out] SecurityS* s);
  };

};
